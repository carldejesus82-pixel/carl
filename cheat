local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

local gui = Instance.new("ScreenGui")
gui.Name = "CustomGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 350)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -175)
mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
mainFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
mainFrame.Parent = gui

local dragToggle = nil
local dragInput = nil
local dragStart = nil
local startPos = nil

local function updateDrag(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragToggle = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragToggle = false
            end
        end)
    end
end)

mainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragToggle then
        updateDrag(input)
    end
end)

local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
topBar.BorderColor3 = Color3.fromRGB(255, 255, 255)
topBar.Parent = mainFrame

local profileText = Instance.new("TextLabel")
profileText.Size = UDim2.new(0.5, 0, 1, 0)
profileText.Position = UDim2.new(0, 10, 0, 0)
profileText.BackgroundTransparency = 1
profileText.Text = "Profile: " .. player.Name
profileText.TextColor3 = Color3.fromRGB(255, 255, 255)
profileText.Font = Enum.Font.GothamBold
profileText.TextScaled = true
profileText.TextXAlignment = Enum.TextXAlignment.Left
profileText.Parent = topBar

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0.5, -10, 1, 0)
fpsLabel.Position = UDim2.new(0.5, 0, 0, 0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.Text = "FPS: 0"
fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
fpsLabel.Font = Enum.Font.GothamBold
fpsLabel.TextScaled = true
fpsLabel.TextXAlignment = Enum.TextXAlignment.Right
fpsLabel.Parent = topBar

local tabsFrame = Instance.new("Frame")
tabsFrame.Size = UDim2.new(1, 0, 0, 30)
tabsFrame.Position = UDim2.new(0, 0, 0, 40)
tabsFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
tabsFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
tabsFrame.Parent = mainFrame

local contentFrame = Instance.new("ScrollingFrame")
contentFrame.Size = UDim2.new(1, 0, 1, -70)
contentFrame.Position = UDim2.new(0, 0, 0, 70)
contentFrame.CanvasSize = UDim2.new(0, 0, 2, 0)
contentFrame.ScrollBarThickness = 6
contentFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
contentFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
contentFrame.Parent = mainFrame

local layout = Instance.new("UIListLayout")
layout.Parent = contentFrame
layout.Padding = UDim.new(0, 5)

local function createTabButton(name, posX)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 100, 1, 0)
    btn.Position = UDim2.new(0, posX, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    btn.BorderColor3 = Color3.fromRGB(255, 255, 255)
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextScaled = true
    btn.Parent = tabsFrame
    return btn
end

local roleplayBtn = createTabButton("Roleplay", 0)
local trollBtn = createTabButton("Troll", 100)
local gunsBtn = createTabButton("Guns", 200)

local sections = {Roleplay = {}, Troll = {}, Guns = {}}

local function createButton(tab, text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    btn.BorderColor3 = Color3.fromRGB(255, 255, 255)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.Gotham
    btn.TextScaled = true
    btn.Parent = contentFrame
    btn.MouseButton1Click:Connect(callback)
    table.insert(sections[tab], btn)
end

createButton("Roleplay", "Infinite Yield", function() loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))() end)
createButton("Roleplay", "ESP", function() print("ESP Activated") end)
createButton("Roleplay", "Aimbot", function() print("Aimbot Activated") end)
createButton("Roleplay", "Faded Menu", function() print("Faded Menu Opened") end)
createButton("Roleplay", "Dex Explorer", function() print("Dex Explorer Opened") end)
createButton("Roleplay", "Music Expo", function() print("Music Expo Loaded") end)
createButton("Roleplay", "FPS Booster", function() print("FPS Booster Activated") end)
createButton("Roleplay", "Big Head", function() print("Big Head Enabled") end)
createButton("Roleplay", "Bring Parts", function() print("Bring Parts Activated") end)
createButton("Roleplay", "Hitbox Expander", function() print("Hitbox Expanded") end)

createButton("Troll", "Fling All", function() print("Fling All Players") end)
createButton("Troll", "Wicked", function() print("Wicked Script Activated") end)

createButton("Guns", "HK416", function() print("Dupe HK416") end)
createButton("Guns", "SP", function() print("Dupe SP") end)
createButton("Guns", "Medkit", function() print("Dupe Medkit") end)
createButton("Guns", "Desert Eagle", function() print("Dupe Deagle") end)
createButton("Guns", "Glock-17", function() print("Dupe Glock-17") end)
createButton("Guns", "Glock-19", function() print("Dupe Glock-19") end)
createButton("Guns", "AK-47", function() print("Dupe AK-47") end)
createButton("Guns", "Bandages", function() print("Dupe Bandages") end)
createButton("Guns", "UZI", function() print("Dupe UZI") end)

local function showTab(tabName)
    for name, buttons in pairs(sections) do
        for _, b in ipairs(buttons) do
            b.Visible = (name == tabName)
        end
    end
end

roleplayBtn.MouseButton1Click:Connect(function() showTab("Roleplay") end)
trollBtn.MouseButton1Click:Connect(function() showTab("Troll") end)
gunsBtn.MouseButton1Click:Connect(function() showTab("Guns") end)

showTab("Roleplay")

local lastUpdate = tick()
local frames = 0
RunService.RenderStepped:Connect(function()
    frames = frames + 1
    if tick() - lastUpdate >= 1 then
        fpsLabel.Text = "FPS: " .. frames
        frames = 0
        lastUpdate = tick()
    end
end)

local mobileToggle = Instance.new("TextButton")
mobileToggle.Size = UDim2.new(0, 80, 0, 25)
mobileToggle.Position = UDim2.new(0.5, -40, 0, 5)
mobileToggle.BackgroundTransparency = 1
mobileToggle.Text = "3KS"
mobileToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
mobileToggle.Font = Enum.Font.GothamBold
mobileToggle.TextScaled = true
mobileToggle.Parent = gui

mobileToggle.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)

UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.K then
        mainFrame.Visible = not mainFrame.Visible
    end
end)
