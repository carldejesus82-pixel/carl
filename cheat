local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local screengui = Instance.new("ScreenGui")
screengui.Name = "KAZO_UI"
screengui.IgnoreGuiInset = true
screengui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(1,0,1,0)
frame.Position = UDim2.new(0,0,0,0)
frame.BackgroundColor3 = Color3.new(0,0,0)
frame.BorderSizePixel = 4
frame.BorderColor3 = Color3.new(1,1,1)
frame.Parent = screengui

local img = Instance.new("ImageLabel")
img.Size = UDim2.new(1,0,1,0)
img.BackgroundTransparency = 1
img.Image = "rbxassetid://133949947924437"
img.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0.1,0)
title.Position = UDim2.new(0,0,0,0)
title.Text = "KAZO MENU"
title.TextScaled = true
title.Font = Enum.Font.SourceSansBold
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.Parent = frame

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0.15,0,0.05,0)
fpsLabel.Position = UDim2.new(0.85,0,0.95,0)
fpsLabel.Text = "FPS: 0"
fpsLabel.TextScaled = true
fpsLabel.Font = Enum.Font.SourceSans
fpsLabel.TextColor3 = Color3.new(1,1,1)
fpsLabel.BackgroundTransparency = 1
fpsLabel.Parent = frame

local avatar = Instance.new("ImageLabel")
avatar.Size = UDim2.new(0.08,0,0.15,0)
avatar.Position = UDim2.new(0.05,0,0.7,0)
avatar.BackgroundTransparency = 1
local thumb = Players:GetUserThumbnailAsync(player.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420)
avatar.Image = thumb
avatar.Parent = frame

local percentLabel = Instance.new("TextLabel")
percentLabel.Size = UDim2.new(0.15,0,0.04,0)
percentLabel.Position = UDim2.new(0.425,0,0.85,0)
percentLabel.Text = "0%"
percentLabel.TextScaled = true
percentLabel.Font = Enum.Font.SourceSansBold
percentLabel.TextColor3 = Color3.new(1,1,1)
percentLabel.BackgroundTransparency = 1
percentLabel.Parent = frame

local barContainer = Instance.new("Frame")
barContainer.Size = UDim2.new(0.35,0,0.015,0)
barContainer.Position = UDim2.new(0.325,0,0.82,0)
barContainer.BackgroundColor3 = Color3.fromRGB(80,80,80)
barContainer.BorderSizePixel = 0
barContainer.Parent = frame
local barCorner = Instance.new("UICorner")
barCorner.Parent = barContainer

local bar = Instance.new("Frame")
bar.Size = UDim2.new(0,0,1,0)
bar.BackgroundColor3 = Color3.new(1,1,1)
bar.BorderSizePixel = 0
bar.Parent = barContainer
local barFillCorner = Instance.new("UICorner")
barFillCorner.Parent = bar

local last = tick()
local count = 0
RunService.RenderStepped:Connect(function()
	count += 1
	if tick() - last >= 1 then
		fpsLabel.Text = "FPS: "..tostring(count)
		count = 0
		last = tick()
	end
end)

local mainGui = Instance.new("Frame")
mainGui.Size = UDim2.new(0.45,0,0.55,0)
mainGui.Position = UDim2.new(0.275,0,0.2,0)
mainGui.BackgroundColor3 = Color3.fromRGB(0,0,0)
mainGui.Visible = false
mainGui.Parent = screengui

local stroke = Instance.new("UIStroke")
stroke.Thickness = 2
stroke.Color = Color3.new(1,1,1)
stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
stroke.Parent = mainGui

local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1,0,0.1,0)
topBar.BackgroundColor3 = Color3.fromRGB(0,0,0)
topBar.Parent = mainGui

local topTitle = Instance.new("TextLabel")
topTitle.Size = UDim2.new(0.6,0,1,0)
topTitle.Position = UDim2.new(0.2,0,0,0)
topTitle.Text = "KAZO MENU"
topTitle.TextScaled = true
topTitle.Font = Enum.Font.SourceSansBold
topTitle.TextColor3 = Color3.new(1,1,1)
topTitle.BackgroundTransparency = 1
topTitle.Parent = topBar

local avatarThumbTop = Instance.new("ImageLabel")
avatarThumbTop.Size = UDim2.new(0.06,0,0.7,0)
avatarThumbTop.Position = UDim2.new(0.01,0,0.15,0)
avatarThumbTop.BackgroundTransparency = 1
avatarThumbTop.Image = thumb
avatarThumbTop.Parent = topBar

local fpsLabelTop = Instance.new("TextLabel")
fpsLabelTop.Size = UDim2.new(0.15,0,1,0)
fpsLabelTop.Position = UDim2.new(0.85,0,0,0)
fpsLabelTop.Text = "FPS: 0"
fpsLabelTop.TextScaled = true
fpsLabelTop.Font = Enum.Font.SourceSans
fpsLabelTop.TextColor3 = Color3.new(1,1,1)
fpsLabelTop.BackgroundTransparency = 1
fpsLabelTop.Parent = topBar

local tabNames = {"ROLEPLAY","TROLL","MATA","DUPES"}
local tabFrame = Instance.new("ScrollingFrame")
tabFrame.Size = UDim2.new(1,0,0.1,0)
tabFrame.Position = UDim2.new(0,0,0.15,0)
tabFrame.BackgroundTransparency = 1
tabFrame.ScrollBarThickness = 6
tabFrame.CanvasSize = UDim2.new(0.23 * #tabNames,0,0,0)
tabFrame.HorizontalScrollBarInset = Enum.ScrollBarInset.Always
tabFrame.ScrollBarImageTransparency = 0.5
tabFrame.AutomaticCanvasSize = Enum.AutomaticSize.X
tabFrame.Parent = mainGui

local tabsButtons = {}
for i, name in ipairs(tabNames) do
	local tab = Instance.new("TextButton")
	tab.Size = UDim2.new(0.22,0,1,0)
	tab.Position = UDim2.new(0.23*(i-1),0,0,0)
	tab.Text = name
	tab.TextScaled = true
	tab.BackgroundColor3 = Color3.fromRGB(30,30,30)
	tab.TextColor3 = Color3.new(1,1,1)
	tab.Parent = tabFrame
	tabsButtons[name] = tab
end

local tabFramesContent = {}
for name,_ in pairs(tabsButtons) do
	local f = Instance.new("Frame")
	f.Size = UDim2.new(1,0,0.6,0)
	f.Position = UDim2.new(0,0,0.3,0)
	f.BackgroundTransparency = 1
	f.Visible = false
	f.Parent = mainGui
	tabFramesContent[name] = f
end
tabFramesContent["ROLEPLAY"].Visible = true

for name, button in pairs(tabsButtons) do
	button.MouseButton1Click:Connect(function()
		for _, f in pairs(tabFramesContent) do
			f.Visible = false
		end
		tabFramesContent[name].Visible = true
	end)
end

local trackBtn = Instance.new("TextButton")
trackBtn.Size = UDim2.new(0.8,0,0.1,0)
trackBtn.Position = UDim2.new(0.1,0,0.05,0)
trackBtn.Text = "Track"
trackBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
trackBtn.TextColor3 = Color3.new(1,1,1)
trackBtn.TextScaled = true
trackBtn.Parent = tabFramesContent["MATA"]

local espEnabled = false

local function clearESP()
	for _, obj in pairs(workspace:GetDescendants()) do
		if obj:IsA("BillboardGui") or obj:IsA("Beam") or obj:IsA("Attachment") then
			if obj.Name == "ESP_Label" or obj.Name == "ESP_Beam" then
				obj:Destroy()
			end
		end
	end
end

trackBtn.MouseButton1Click:Connect(function()
	espEnabled = not espEnabled
	if not espEnabled then
		clearESP()
		return
	end
	for _, otherPlayer in pairs(Players:GetPlayers()) do
		if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
			local targetHRP = otherPlayer.Character.HumanoidRootPart
			local localHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
			if localHRP then
				local att0 = Instance.new("Attachment")
				att0.Name = "ESP_Beam"
				att0.Position = Vector3.new(0,0,0)
				att0.Parent = localHRP

				local att1 = Instance.new("Attachment")
				att1.Name = "ESP_Beam"
				att1.Position = Vector3.new(0,0,0)
				att1.Parent = targetHRP

				local beam = Instance.new("Beam")
				beam.Name = "ESP_Beam"
				beam.Attachment0 = att0
				beam.Attachment1 = att1
				beam.Color = ColorSequence.new(Color3.new(1,1,1))
				beam.Width0 = 0.08
				beam.Width1 = 0.08
				beam.FaceCamera = true
				beam.Transparency = NumberSequence.new(0)
				beam.Parent = localHRP

				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESP_Label"
				billboard.Adornee = targetHRP
				billboard.Size = UDim2.new(0,80,0,25)
				billboard.AlwaysOnTop = true
				billboard.Parent = targetHRP

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1,0,1,0)
				label.Text = otherPlayer.Name
				label.TextScaled = true
				label.BackgroundTransparency = 1
				label.TextColor3 = Color3.new(1,1,1)
				label.Parent = billboard
			end
		end
	end
end)

local dragging = false
local dragInput
local dragStart
local startPos
local function update(input)
	local delta = input.Position - dragStart
	mainGui.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

mainGui.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = mainGui.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

mainGui.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)

UserInputService.InputBegan:Connect(function(input, gpe)
	if not gpe and input.KeyCode == Enum.KeyCode.K then
		mainGui.Visible = not mainGui.Visible
	end
end)

task.spawn(function()
	for i = 1,100 do
		bar.Size = UDim2.new(i/100,0,1,0)
		percentLabel.Text = i.."%"
		task.wait(0.05)
	end
	frame:Destroy()
	mainGui.Visible = true
end)
